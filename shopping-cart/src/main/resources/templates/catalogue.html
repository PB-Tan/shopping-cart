<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Catalogue</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <style>
      body {
        background: #f5f5f5;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }

      .catalogue-container {
        padding: 40px 50px;
        max-width: 1400px;
        margin: 0 auto;
      }

      .catalogue-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 40px;
        letter-spacing: -0.5px;
      }

      .product-card {
        position: relative;
        background: white;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        border: 1px solid #e8e8e8;
        height: 100%;
        display: flex;
        flex-direction: column;
      }

      .product-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
      }

      .favorite-form {
        position: absolute;
        top: 16px;
        right: 16px;
        z-index: 10;
      }

      .favorite-btn {
        background: rgba(255, 255, 255, 0.95);
        border: none;
        border-radius: 50%;
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        transition: all 0.3s ease;
        padding: 0;
        backdrop-filter: blur(10px);
      }

      .favorite-btn:hover {
        transform: scale(1.15);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        background: white;
      }

      .favorite-btn svg {
        width: 22px;
        height: 22px;
      }

      .favorite-btn.favorited svg {
        fill: #ff4d4d;
        stroke: #ff4d4d;
      }

      .favorite-btn:not(.favorited) svg {
        fill: none;
        stroke: #555;
        stroke-width: 2.5;
      }

      .product-image-container {
        width: 100%;
        height: 300px;
        background: #fafafa;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        border-bottom: 1px solid #f0f0f0;
      }

      .product-card img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        transition: transform 0.4s ease;
      }

      .product-card:hover img {
        transform: scale(1.05);
      }

      .product-body {
        padding: 24px;
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      .product-name {
        font-size: 1.25rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 12px;
        line-height: 1.4;
        min-height: 60px;
      }

      .product-description {
        font-size: 0.95rem;
        color: #7f8c8d;
        margin-bottom: 16px;
        line-height: 1.6;
        flex: 1;
      }

      .product-price {
        font-size: 1.75rem;
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 20px;
        letter-spacing: -0.5px;
      }

      .btn-view-detail {
        background: #2c3e50;
        color: white;
        border: none;
        border-radius: 10px;
        padding: 14px 28px;
        font-weight: 600;
        font-size: 0.95rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        transition: all 0.3s ease;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        width: 100%;
      }

      .btn-view-detail:hover {
        background: #34495e;
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(44, 62, 80, 0.3);
        text-decoration: none;
      }

      @media (max-width: 992px) {
        .catalogue-container {
          padding: 30px 20px;
        }

        .catalogue-title {
          font-size: 2rem;
        }
      }
    </style>
  </head>

  <body>
    <div th:replace="fragments/layout :: siteHeader"></div>
    <div class="catalogue-container">
      <h2 class="catalogue-title">Product Catalogue</h2>
      <div class="row">
        <div class="col-lg-4 col-md-6 col-sm-12 mb-4" th:each="p : ${productlist}">
          <div class="product-card">
            <form
              th:action="@{/favorites/toggle}"
              method="post"
              class="favorite-form"
            >
              <input type="hidden" name="productId" th:value="${p.id}" />
              <input type="hidden" name="returnUrl" value="/catalogue" />
              <button
                type="submit"
                class="favorite-btn"
                th:classappend="${favoritedProductIds.contains(p.id)} ? 'favorited' : ''"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"
                  ></path>
                </svg>
              </button>
            </form>
            <div class="product-image-container">
              <img
                th:src="@{${p.imageUrl}}"
                alt="product"
              />
            </div>
            <div class="product-body">
              <h5 class="product-name" th:text="${p.name}"></h5>
              <p class="product-description" th:text="${p.description}"></p>
              <p
                class="product-price"
                th:text="${'$' + #numbers.formatDecimal(p.unitPrice,0,'COMMA',2, 'POINT')}"
              ></p>
              <a th:href="@{catalogue/{id}(id=${p.id})}" class="btn-view-detail"
                >View Detail</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
